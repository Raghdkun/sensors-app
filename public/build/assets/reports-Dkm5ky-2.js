import{r as d,j as t,a as nt,c as L,H as Ot}from"./app-Ceqq5dSL.js";import{C as Z,d as J,R as rt,B as de,a as Ue,b as We,c as Ke}from"./badge-Mv6pxrcU.js";import{a as H,b as $t,u as K,c as ue,B as z}from"./app-logo-icon-CdDhz7_B.js";import{u as Ze,c as k,a as ee}from"./index-DpGmPMZN.js";import{u as zt,R as Lt,c as qe,d as Vt,P as Bt,e as ot,f as Ft,V as Ht,g as Ut,h as Wt,i as Kt,j as qt,F as Gt,D as Xt,C as Yt,k as Zt,A as Jt}from"./app-layout-DjmKgjDt.js";import{u as Qt}from"./index-DtzoCmJ-.js";import{C as at,a as es,P as Je,T as ts}from"./trash-2-pYPQVltt.js";import{C as ss}from"./check-CR144Lvi.js";import{S as De,T as Oe}from"./skeleton-C5-MN2jM.js";import{S as Q}from"./spinner-DJM2zdHL.js";import{C as $e,D as lt,W as it}from"./wifi-off-DXVooWAk.js";/* empty css            */import"./index-j7bSEhQD.js";import"./index-H92Pz0xW.js";import"./loader-circle-BIKxyZHH.js";const ns=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],rs=H("ArrowDown",ns);const os=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],as=H("ArrowUp",os);const ls=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],is=H("Calendar",ls);const cs=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ye=H("ChartColumn",cs);const ds=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],us=H("CircleCheck",ds);const ms=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Qe=H("Download",ms);const ps=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],fs=H("Pause",ps);const xs=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],hs=H("Play",xs);const gs=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],vs=H("Settings2",gs);const ys=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],xe=H("TriangleAlert",ys);const js=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ss=H("Zap",js);function et(n,[e,s]){return Math.min(s,Math.max(e,n))}function Ns(n,e=[]){let s=[];function r(l,a){const i=d.createContext(a),c=s.length;s=[...s,a];const u=x=>{const{scope:g,children:S,...N}=x,f=g?.[n]?.[c]||i,j=d.useMemo(()=>N,Object.values(N));return t.jsx(f.Provider,{value:j,children:S})};u.displayName=l+"Provider";function h(x,g){const S=g?.[n]?.[c]||i,N=d.useContext(S);if(N)return N;if(a!==void 0)return a;throw new Error(`\`${x}\` must be used within \`${l}\``)}return[u,h]}const o=()=>{const l=s.map(a=>d.createContext(a));return function(i){const c=i?.[n]||l;return d.useMemo(()=>({[`__scope${n}`]:{...i,[n]:c}}),[i,c])}};return o.scopeName=n,[r,bs(o,...e)]}function bs(...n){const e=n[0];if(n.length===1)return e;const s=()=>{const r=n.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(l){const a=r.reduce((i,{useScope:c,scopeName:u})=>{const x=c(l)[`__scope${u}`];return{...i,...x}},{});return d.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return s.scopeName=e.scopeName,s}function ct(n){const e=ws(n),s=d.forwardRef((r,o)=>{const{children:l,...a}=r,i=d.Children.toArray(l),c=i.find(_s);if(c){const u=c.props.children,h=i.map(x=>x===c?d.Children.count(u)>1?d.Children.only(null):d.isValidElement(u)?u.props.children:null:x);return t.jsx(e,{...a,ref:o,children:d.isValidElement(u)?d.cloneElement(u,void 0,h):null})}return t.jsx(e,{...a,ref:o,children:l})});return s.displayName=`${n}.Slot`,s}function ws(n){const e=d.forwardRef((s,r)=>{const{children:o,...l}=s;if(d.isValidElement(o)){const a=Es(o),i=Ts(l,o.props);return o.type!==d.Fragment&&(i.ref=r?$t(r,a):a),d.cloneElement(o,i)}return d.Children.count(o)>1?d.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var Cs=Symbol("radix.slottable");function _s(n){return d.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===Cs}function Ts(n,e){const s={...e};for(const r in e){const o=n[r],l=e[r];/^on[A-Z]/.test(r)?o&&l?s[r]=(...i)=>{const c=l(...i);return o(...i),c}:o&&(s[r]=o):r==="style"?s[r]={...o,...l}:r==="className"&&(s[r]=[o,l].filter(Boolean).join(" "))}return{...n,...s}}function Es(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning;return s?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,s=e&&"isReactWarning"in e&&e.isReactWarning,s?n.props.ref:n.props.ref||n.ref)}var Is=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],O=Is.reduce((n,e)=>{const s=ct(`Primitive.${e}`),r=d.forwardRef((o,l)=>{const{asChild:a,...i}=o,c=a?s:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(c,{...i,ref:l})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{}),Rs=[" ","Enter","ArrowUp","ArrowDown"],Ps=[" ","Enter"],ae="Select",[_e,Te,ks]=Ft(ae),[me]=Ns(ae,[ks,ot]),Ee=ot(),[Ms,te]=me(ae),[As,Ds]=me(ae),dt=n=>{const{__scopeSelect:e,children:s,open:r,defaultOpen:o,onOpenChange:l,value:a,defaultValue:i,onValueChange:c,dir:u,name:h,autoComplete:x,disabled:g,required:S,form:N}=n,f=Ee(e),[j,w]=d.useState(null),[p,v]=d.useState(null),[I,C]=d.useState(!1),ne=zt(u),[P,$]=Ze({prop:r,defaultProp:o??!1,onChange:l,caller:ae}),[U,q]=Ze({prop:a,defaultProp:i,onChange:c,caller:ae}),V=d.useRef(null),B=j?N||!!j.closest("form"):!0,[m,b]=d.useState(new Set),G=Array.from(m).map(A=>A.props.value).join(";");return t.jsx(Lt,{...f,children:t.jsxs(Ms,{required:S,scope:e,trigger:j,onTriggerChange:w,valueNode:p,onValueNodeChange:v,valueNodeHasChildren:I,onValueNodeHasChildrenChange:C,contentId:qe(),value:U,onValueChange:q,open:P,onOpenChange:$,dir:ne,triggerPointerDownPosRef:V,disabled:g,children:[t.jsx(_e.Provider,{scope:e,children:t.jsx(As,{scope:n.__scopeSelect,onNativeOptionAdd:d.useCallback(A=>{b(W=>new Set(W).add(A))},[]),onNativeOptionRemove:d.useCallback(A=>{b(W=>{const X=new Set(W);return X.delete(A),X})},[]),children:s})}),B?t.jsxs(kt,{"aria-hidden":!0,required:S,tabIndex:-1,name:h,autoComplete:x,value:U,onChange:A=>q(A.target.value),disabled:g,form:N,children:[U===void 0?t.jsx("option",{value:""}):null,Array.from(m)]},G):null]})})};dt.displayName=ae;var ut="SelectTrigger",mt=d.forwardRef((n,e)=>{const{__scopeSelect:s,disabled:r=!1,...o}=n,l=Ee(s),a=te(ut,s),i=a.disabled||r,c=K(e,a.onTriggerChange),u=Te(s),h=d.useRef("touch"),[x,g,S]=At(f=>{const j=u().filter(v=>!v.disabled),w=j.find(v=>v.value===a.value),p=Dt(j,f,w);p!==void 0&&a.onValueChange(p.value)}),N=f=>{i||(a.onOpenChange(!0),S()),f&&(a.triggerPointerDownPosRef.current={x:Math.round(f.pageX),y:Math.round(f.pageY)})};return t.jsx(Vt,{asChild:!0,...l,children:t.jsx(O.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":Mt(a.value)?"":void 0,...o,ref:c,onClick:k(o.onClick,f=>{f.currentTarget.focus(),h.current!=="mouse"&&N(f)}),onPointerDown:k(o.onPointerDown,f=>{h.current=f.pointerType;const j=f.target;j.hasPointerCapture(f.pointerId)&&j.releasePointerCapture(f.pointerId),f.button===0&&f.ctrlKey===!1&&f.pointerType==="mouse"&&(N(f),f.preventDefault())}),onKeyDown:k(o.onKeyDown,f=>{const j=x.current!=="";!(f.ctrlKey||f.altKey||f.metaKey)&&f.key.length===1&&g(f.key),!(j&&f.key===" ")&&Rs.includes(f.key)&&(N(),f.preventDefault())})})})});mt.displayName=ut;var pt="SelectValue",ft=d.forwardRef((n,e)=>{const{__scopeSelect:s,className:r,style:o,children:l,placeholder:a="",...i}=n,c=te(pt,s),{onValueNodeHasChildrenChange:u}=c,h=l!==void 0,x=K(e,c.onValueNodeChange);return ee(()=>{u(h)},[u,h]),t.jsx(O.span,{...i,ref:x,style:{pointerEvents:"none"},children:Mt(c.value)?t.jsx(t.Fragment,{children:a}):l})});ft.displayName=pt;var Os="SelectIcon",xt=d.forwardRef((n,e)=>{const{__scopeSelect:s,children:r,...o}=n;return t.jsx(O.span,{"aria-hidden":!0,...o,ref:e,children:r||"▼"})});xt.displayName=Os;var $s="SelectPortal",ht=n=>t.jsx(Bt,{asChild:!0,...n});ht.displayName=$s;var le="SelectContent",gt=d.forwardRef((n,e)=>{const s=te(le,n.__scopeSelect),[r,o]=d.useState();if(ee(()=>{o(new DocumentFragment)},[]),!s.open){const l=r;return l?nt.createPortal(t.jsx(vt,{scope:n.__scopeSelect,children:t.jsx(_e.Slot,{scope:n.__scopeSelect,children:t.jsx("div",{children:n.children})})}),l):null}return t.jsx(yt,{...n,ref:e})});gt.displayName=le;var F=10,[vt,se]=me(le),zs="SelectContentImpl",Ls=ct("SelectContent.RemoveScroll"),yt=d.forwardRef((n,e)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:l,onPointerDownOutside:a,side:i,sideOffset:c,align:u,alignOffset:h,arrowPadding:x,collisionBoundary:g,collisionPadding:S,sticky:N,hideWhenDetached:f,avoidCollisions:j,...w}=n,p=te(le,s),[v,I]=d.useState(null),[C,ne]=d.useState(null),P=K(e,y=>I(y)),[$,U]=d.useState(null),[q,V]=d.useState(null),B=Te(s),[m,b]=d.useState(!1),G=d.useRef(!1);d.useEffect(()=>{if(v)return Wt(v)},[v]),Kt();const A=d.useCallback(y=>{const[E,...D]=B().map(R=>R.ref.current),[_]=D.slice(-1),T=document.activeElement;for(const R of y)if(R===T||(R?.scrollIntoView({block:"nearest"}),R===E&&C&&(C.scrollTop=0),R===_&&C&&(C.scrollTop=C.scrollHeight),R?.focus(),document.activeElement!==T))return},[B,C]),W=d.useCallback(()=>A([$,v]),[A,$,v]);d.useEffect(()=>{m&&W()},[m,W]);const{onOpenChange:X,triggerPointerDownPosRef:Y}=p;d.useEffect(()=>{if(v){let y={x:0,y:0};const E=_=>{y={x:Math.abs(Math.round(_.pageX)-(Y.current?.x??0)),y:Math.abs(Math.round(_.pageY)-(Y.current?.y??0))}},D=_=>{y.x<=10&&y.y<=10?_.preventDefault():v.contains(_.target)||X(!1),document.removeEventListener("pointermove",E),Y.current=null};return Y.current!==null&&(document.addEventListener("pointermove",E),document.addEventListener("pointerup",D,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",D,{capture:!0})}}},[v,X,Y]),d.useEffect(()=>{const y=()=>X(!1);return window.addEventListener("blur",y),window.addEventListener("resize",y),()=>{window.removeEventListener("blur",y),window.removeEventListener("resize",y)}},[X]);const[Ie,he]=At(y=>{const E=B().filter(T=>!T.disabled),D=E.find(T=>T.ref.current===document.activeElement),_=Dt(E,y,D);_&&setTimeout(()=>_.ref.current.focus())}),Re=d.useCallback((y,E,D)=>{const _=!G.current&&!D;(p.value!==void 0&&p.value===E||_)&&(U(y),_&&(G.current=!0))},[p.value]),Pe=d.useCallback(()=>v?.focus(),[v]),ie=d.useCallback((y,E,D)=>{const _=!G.current&&!D;(p.value!==void 0&&p.value===E||_)&&V(y)},[p.value]),ge=r==="popper"?ze:jt,pe=ge===ze?{side:i,sideOffset:c,align:u,alignOffset:h,arrowPadding:x,collisionBoundary:g,collisionPadding:S,sticky:N,hideWhenDetached:f,avoidCollisions:j}:{};return t.jsx(vt,{scope:s,content:v,viewport:C,onViewportChange:ne,itemRefCallback:Re,selectedItem:$,onItemLeave:Pe,itemTextRefCallback:ie,focusSelectedItem:W,selectedItemText:q,position:r,isPositioned:m,searchRef:Ie,children:t.jsx(qt,{as:Ls,allowPinchZoom:!0,children:t.jsx(Gt,{asChild:!0,trapped:p.open,onMountAutoFocus:y=>{y.preventDefault()},onUnmountAutoFocus:k(o,y=>{p.trigger?.focus({preventScroll:!0}),y.preventDefault()}),children:t.jsx(Xt,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:a,onFocusOutside:y=>y.preventDefault(),onDismiss:()=>p.onOpenChange(!1),children:t.jsx(ge,{role:"listbox",id:p.contentId,"data-state":p.open?"open":"closed",dir:p.dir,onContextMenu:y=>y.preventDefault(),...w,...pe,onPlaced:()=>b(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:k(w.onKeyDown,y=>{const E=y.ctrlKey||y.altKey||y.metaKey;if(y.key==="Tab"&&y.preventDefault(),!E&&y.key.length===1&&he(y.key),["ArrowUp","ArrowDown","Home","End"].includes(y.key)){let _=B().filter(T=>!T.disabled).map(T=>T.ref.current);if(["ArrowUp","End"].includes(y.key)&&(_=_.slice().reverse()),["ArrowUp","ArrowDown"].includes(y.key)){const T=y.target,R=_.indexOf(T);_=_.slice(R+1)}setTimeout(()=>A(_)),y.preventDefault()}})})})})})})});yt.displayName=zs;var Vs="SelectItemAlignedPosition",jt=d.forwardRef((n,e)=>{const{__scopeSelect:s,onPlaced:r,...o}=n,l=te(le,s),a=se(le,s),[i,c]=d.useState(null),[u,h]=d.useState(null),x=K(e,P=>h(P)),g=Te(s),S=d.useRef(!1),N=d.useRef(!0),{viewport:f,selectedItem:j,selectedItemText:w,focusSelectedItem:p}=a,v=d.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&u&&f&&j&&w){const P=l.trigger.getBoundingClientRect(),$=u.getBoundingClientRect(),U=l.valueNode.getBoundingClientRect(),q=w.getBoundingClientRect();if(l.dir!=="rtl"){const T=q.left-$.left,R=U.left-T,re=P.left-R,oe=P.width+re,ke=Math.max(oe,$.width),Me=window.innerWidth-F,Ae=et(R,[F,Math.max(F,Me-ke)]);i.style.minWidth=oe+"px",i.style.left=Ae+"px"}else{const T=$.right-q.right,R=window.innerWidth-U.right-T,re=window.innerWidth-P.right-R,oe=P.width+re,ke=Math.max(oe,$.width),Me=window.innerWidth-F,Ae=et(R,[F,Math.max(F,Me-ke)]);i.style.minWidth=oe+"px",i.style.right=Ae+"px"}const V=g(),B=window.innerHeight-F*2,m=f.scrollHeight,b=window.getComputedStyle(u),G=parseInt(b.borderTopWidth,10),A=parseInt(b.paddingTop,10),W=parseInt(b.borderBottomWidth,10),X=parseInt(b.paddingBottom,10),Y=G+A+m+X+W,Ie=Math.min(j.offsetHeight*5,Y),he=window.getComputedStyle(f),Re=parseInt(he.paddingTop,10),Pe=parseInt(he.paddingBottom,10),ie=P.top+P.height/2-F,ge=B-ie,pe=j.offsetHeight/2,y=j.offsetTop+pe,E=G+A+y,D=Y-E;if(E<=ie){const T=V.length>0&&j===V[V.length-1].ref.current;i.style.bottom="0px";const R=u.clientHeight-f.offsetTop-f.offsetHeight,re=Math.max(ge,pe+(T?Pe:0)+R+W),oe=E+re;i.style.height=oe+"px"}else{const T=V.length>0&&j===V[0].ref.current;i.style.top="0px";const re=Math.max(ie,G+f.offsetTop+(T?Re:0)+pe)+D;i.style.height=re+"px",f.scrollTop=E-ie+f.offsetTop}i.style.margin=`${F}px 0`,i.style.minHeight=Ie+"px",i.style.maxHeight=B+"px",r?.(),requestAnimationFrame(()=>S.current=!0)}},[g,l.trigger,l.valueNode,i,u,f,j,w,l.dir,r]);ee(()=>v(),[v]);const[I,C]=d.useState();ee(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const ne=d.useCallback(P=>{P&&N.current===!0&&(v(),p?.(),N.current=!1)},[v,p]);return t.jsx(Fs,{scope:s,contentWrapper:i,shouldExpandOnScrollRef:S,onScrollButtonChange:ne,children:t.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I},children:t.jsx(O.div,{...o,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});jt.displayName=Vs;var Bs="SelectPopperPosition",ze=d.forwardRef((n,e)=>{const{__scopeSelect:s,align:r="start",collisionPadding:o=F,...l}=n,a=Ee(s);return t.jsx(Yt,{...a,...l,ref:e,align:r,collisionPadding:o,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ze.displayName=Bs;var[Fs,Ge]=me(le,{}),Le="SelectViewport",St=d.forwardRef((n,e)=>{const{__scopeSelect:s,nonce:r,...o}=n,l=se(Le,s),a=Ge(Le,s),i=K(e,l.onViewportChange),c=d.useRef(0);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),t.jsx(_e.Slot,{scope:s,children:t.jsx(O.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:k(o.onScroll,u=>{const h=u.currentTarget,{contentWrapper:x,shouldExpandOnScrollRef:g}=a;if(g?.current&&x){const S=Math.abs(c.current-h.scrollTop);if(S>0){const N=window.innerHeight-F*2,f=parseFloat(x.style.minHeight),j=parseFloat(x.style.height),w=Math.max(f,j);if(w<N){const p=w+S,v=Math.min(N,p),I=p-v;x.style.height=v+"px",x.style.bottom==="0px"&&(h.scrollTop=I>0?I:0,x.style.justifyContent="flex-end")}}}c.current=h.scrollTop})})})]})});St.displayName=Le;var Nt="SelectGroup",[Hs,Us]=me(Nt),Ws=d.forwardRef((n,e)=>{const{__scopeSelect:s,...r}=n,o=qe();return t.jsx(Hs,{scope:s,id:o,children:t.jsx(O.div,{role:"group","aria-labelledby":o,...r,ref:e})})});Ws.displayName=Nt;var bt="SelectLabel",Ks=d.forwardRef((n,e)=>{const{__scopeSelect:s,...r}=n,o=Us(bt,s);return t.jsx(O.div,{id:o.id,...r,ref:e})});Ks.displayName=bt;var Ce="SelectItem",[qs,wt]=me(Ce),Ct=d.forwardRef((n,e)=>{const{__scopeSelect:s,value:r,disabled:o=!1,textValue:l,...a}=n,i=te(Ce,s),c=se(Ce,s),u=i.value===r,[h,x]=d.useState(l??""),[g,S]=d.useState(!1),N=K(e,p=>c.itemRefCallback?.(p,r,o)),f=qe(),j=d.useRef("touch"),w=()=>{o||(i.onValueChange(r),i.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return t.jsx(qs,{scope:s,value:r,disabled:o,textId:f,isSelected:u,onItemTextChange:d.useCallback(p=>{x(v=>v||(p?.textContent??"").trim())},[]),children:t.jsx(_e.ItemSlot,{scope:s,value:r,disabled:o,textValue:h,children:t.jsx(O.div,{role:"option","aria-labelledby":f,"data-highlighted":g?"":void 0,"aria-selected":u&&g,"data-state":u?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...a,ref:N,onFocus:k(a.onFocus,()=>S(!0)),onBlur:k(a.onBlur,()=>S(!1)),onClick:k(a.onClick,()=>{j.current!=="mouse"&&w()}),onPointerUp:k(a.onPointerUp,()=>{j.current==="mouse"&&w()}),onPointerDown:k(a.onPointerDown,p=>{j.current=p.pointerType}),onPointerMove:k(a.onPointerMove,p=>{j.current=p.pointerType,o?c.onItemLeave?.():j.current==="mouse"&&p.currentTarget.focus({preventScroll:!0})}),onPointerLeave:k(a.onPointerLeave,p=>{p.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:k(a.onKeyDown,p=>{c.searchRef?.current!==""&&p.key===" "||(Ps.includes(p.key)&&w(),p.key===" "&&p.preventDefault())})})})})});Ct.displayName=Ce;var fe="SelectItemText",_t=d.forwardRef((n,e)=>{const{__scopeSelect:s,className:r,style:o,...l}=n,a=te(fe,s),i=se(fe,s),c=wt(fe,s),u=Ds(fe,s),[h,x]=d.useState(null),g=K(e,w=>x(w),c.onItemTextChange,w=>i.itemTextRefCallback?.(w,c.value,c.disabled)),S=h?.textContent,N=d.useMemo(()=>t.jsx("option",{value:c.value,disabled:c.disabled,children:S},c.value),[c.disabled,c.value,S]),{onNativeOptionAdd:f,onNativeOptionRemove:j}=u;return ee(()=>(f(N),()=>j(N)),[f,j,N]),t.jsxs(t.Fragment,{children:[t.jsx(O.span,{id:c.textId,...l,ref:g}),c.isSelected&&a.valueNode&&!a.valueNodeHasChildren?nt.createPortal(l.children,a.valueNode):null]})});_t.displayName=fe;var Tt="SelectItemIndicator",Et=d.forwardRef((n,e)=>{const{__scopeSelect:s,...r}=n;return wt(Tt,s).isSelected?t.jsx(O.span,{"aria-hidden":!0,...r,ref:e}):null});Et.displayName=Tt;var Ve="SelectScrollUpButton",It=d.forwardRef((n,e)=>{const s=se(Ve,n.__scopeSelect),r=Ge(Ve,n.__scopeSelect),[o,l]=d.useState(!1),a=K(e,r.onScrollButtonChange);return ee(()=>{if(s.viewport&&s.isPositioned){let i=function(){const u=c.scrollTop>0;l(u)};const c=s.viewport;return i(),c.addEventListener("scroll",i),()=>c.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),o?t.jsx(Pt,{...n,ref:a,onAutoScroll:()=>{const{viewport:i,selectedItem:c}=s;i&&c&&(i.scrollTop=i.scrollTop-c.offsetHeight)}}):null});It.displayName=Ve;var Be="SelectScrollDownButton",Rt=d.forwardRef((n,e)=>{const s=se(Be,n.__scopeSelect),r=Ge(Be,n.__scopeSelect),[o,l]=d.useState(!1),a=K(e,r.onScrollButtonChange);return ee(()=>{if(s.viewport&&s.isPositioned){let i=function(){const u=c.scrollHeight-c.clientHeight,h=Math.ceil(c.scrollTop)<u;l(h)};const c=s.viewport;return i(),c.addEventListener("scroll",i),()=>c.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),o?t.jsx(Pt,{...n,ref:a,onAutoScroll:()=>{const{viewport:i,selectedItem:c}=s;i&&c&&(i.scrollTop=i.scrollTop+c.offsetHeight)}}):null});Rt.displayName=Be;var Pt=d.forwardRef((n,e)=>{const{__scopeSelect:s,onAutoScroll:r,...o}=n,l=se("SelectScrollButton",s),a=d.useRef(null),i=Te(s),c=d.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return d.useEffect(()=>()=>c(),[c]),ee(()=>{i().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[i]),t.jsx(O.div,{"aria-hidden":!0,...o,ref:e,style:{flexShrink:0,...o.style},onPointerDown:k(o.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:k(o.onPointerMove,()=>{l.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:k(o.onPointerLeave,()=>{c()})})}),Gs="SelectSeparator",Xs=d.forwardRef((n,e)=>{const{__scopeSelect:s,...r}=n;return t.jsx(O.div,{"aria-hidden":!0,...r,ref:e})});Xs.displayName=Gs;var Fe="SelectArrow",Ys=d.forwardRef((n,e)=>{const{__scopeSelect:s,...r}=n,o=Ee(s),l=te(Fe,s),a=se(Fe,s);return l.open&&a.position==="popper"?t.jsx(Zt,{...o,...r,ref:e}):null});Ys.displayName=Fe;var Zs="SelectBubbleInput",kt=d.forwardRef(({__scopeSelect:n,value:e,...s},r)=>{const o=d.useRef(null),l=K(r,o),a=Qt(e);return d.useEffect(()=>{const i=o.current;if(!i)return;const c=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==e&&h){const x=new Event("change",{bubbles:!0});h.call(i,e),i.dispatchEvent(x)}},[a,e]),t.jsx(O.select,{...s,style:{...Ht,...s.style},ref:l,defaultValue:e})});kt.displayName=Zs;function Mt(n){return n===""||n===void 0}function At(n){const e=Ut(n),s=d.useRef(""),r=d.useRef(0),o=d.useCallback(a=>{const i=s.current+a;e(i),(function c(u){s.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))})(i)},[e]),l=d.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return d.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,o,l]}function Dt(n,e,s){const o=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,l=s?n.indexOf(s):-1;let a=Js(n,Math.max(l,0));o.length===1&&(a=a.filter(u=>u!==s));const c=a.find(u=>u.textValue.toLowerCase().startsWith(o.toLowerCase()));return c!==s?c:void 0}function Js(n,e){return n.map((s,r)=>n[(e+r)%n.length])}var Qs=dt,en=mt,tn=ft,sn=xt,nn=ht,rn=gt,on=St,an=Ct,ln=_t,cn=Et,dn=It,un=Rt;function je(n){const e=L.c(4);let s;e[0]!==n?({...s}=n,e[0]=n,e[1]=s):s=e[1];let r;return e[2]!==s?(r=t.jsx(Qs,{"data-slot":"select",...s}),e[2]=s,e[3]=r):r=e[3],r}function Se(n){const e=L.c(4);let s;e[0]!==n?({...s}=n,e[0]=n,e[1]=s):s=e[1];let r;return e[2]!==s?(r=t.jsx(tn,{"data-slot":"select-value",...s}),e[2]=s,e[3]=r):r=e[3],r}function Ne(n){const e=L.c(11);let s,r,o;e[0]!==n?({className:r,children:s,...o}=n,e[0]=n,e[1]=s,e[2]=r,e[3]=o):(s=e[1],r=e[2],o=e[3]);let l;e[4]!==r?(l=ue("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-full items-center justify-between rounded-md border bg-transparent px-3 py-2 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&>span]:line-clamp-1",r),e[4]=r,e[5]=l):l=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(sn,{asChild:!0,children:t.jsx(at,{className:"size-4 opacity-50"})}),e[6]=a):a=e[6];let i;return e[7]!==s||e[8]!==o||e[9]!==l?(i=t.jsxs(en,{"data-slot":"select-trigger",className:l,...o,children:[s,a]}),e[7]=s,e[8]=o,e[9]=l,e[10]=i):i=e[10],i}function be(n){const e=L.c(20);let s,r,o,l;e[0]!==n?({className:r,children:s,position:l,...o}=n,e[0]=n,e[1]=s,e[2]=r,e[3]=o,e[4]=l):(s=e[1],r=e[2],o=e[3],l=e[4]);const a=l===void 0?"popper":l,i=a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let c;e[5]!==r||e[6]!==i?(c=ue("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",i,r),e[5]=r,e[6]=i,e[7]=c):c=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(mn,{}),e[8]=u):u=e[8];const h=a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1";let x;e[9]!==h?(x=ue("p-1",h),e[9]=h,e[10]=x):x=e[10];let g;e[11]!==s||e[12]!==x?(g=t.jsx(on,{className:x,children:s}),e[11]=s,e[12]=x,e[13]=g):g=e[13];let S;e[14]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(pn,{}),e[14]=S):S=e[14];let N;return e[15]!==a||e[16]!==o||e[17]!==c||e[18]!==g?(N=t.jsx(nn,{children:t.jsxs(rn,{"data-slot":"select-content",className:c,position:a,...o,children:[u,g,S]})}),e[15]=a,e[16]=o,e[17]=c,e[18]=g,e[19]=N):N=e[19],N}function we(n){const e=L.c(13);let s,r,o;e[0]!==n?({className:r,children:s,...o}=n,e[0]=n,e[1]=s,e[2]=r,e[3]=o):(s=e[1],r=e[2],o=e[3]);let l;e[4]!==r?(l=ue("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",r),e[4]=r,e[5]=l):l=e[5];let a;e[6]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:t.jsx(cn,{children:t.jsx(ss,{className:"size-4"})})}),e[6]=a):a=e[6];let i;e[7]!==s?(i=t.jsx(ln,{children:s}),e[7]=s,e[8]=i):i=e[8];let c;return e[9]!==o||e[10]!==l||e[11]!==i?(c=t.jsxs(an,{"data-slot":"select-item",className:l,...o,children:[a,i]}),e[9]=o,e[10]=l,e[11]=i,e[12]=c):c=e[12],c}function mn(n){const e=L.c(9);let s,r;e[0]!==n?({className:s,...r}=n,e[0]=n,e[1]=s,e[2]=r):(s=e[1],r=e[2]);let o;e[3]!==s?(o=ue("flex cursor-default items-center justify-center py-1",s),e[3]=s,e[4]=o):o=e[4];let l;e[5]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(es,{className:"size-4"}),e[5]=l):l=e[5];let a;return e[6]!==r||e[7]!==o?(a=t.jsx(dn,{"data-slot":"select-scroll-up-button",className:o,...r,children:l}),e[6]=r,e[7]=o,e[8]=a):a=e[8],a}function pn(n){const e=L.c(9);let s,r;e[0]!==n?({className:s,...r}=n,e[0]=n,e[1]=s,e[2]=r):(s=e[1],r=e[2]);let o;e[3]!==s?(o=ue("flex cursor-default items-center justify-center py-1",s),e[3]=s,e[4]=o):o=e[4];let l;e[5]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(at,{className:"size-4"}),e[5]=l):l=e[5];let a;return e[6]!==r||e[7]!==o?(a=t.jsx(un,{"data-slot":"select-scroll-down-button",className:o,...r,children:l}),e[6]=r,e[7]=o,e[8]=a):a=e[8],a}function M(n,e=1){return n==null?"—":Number(n).toFixed(e)}function tt(n){return new Date(n).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function st(n){return{daily:"Today",weekly:"This Week",monthly:"This Month"}[n]}function Xe(n){return n==null?"text-muted-foreground":n<=32?"text-blue-600 dark:text-blue-400":n<=60?"text-teal-600 dark:text-teal-400":n<=80?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}function Ye(n){return n==null?"text-muted-foreground":n<=30?"text-amber-600 dark:text-amber-400":n<=60?"text-emerald-600 dark:text-emerald-400":"text-blue-600 dark:text-blue-400"}function ve(n){const e=L.c(16),{label:s,value:r,subtitle:o,icon:l,colorClass:a}=n;let i;e[0]!==s?(i=t.jsx("p",{className:"text-muted-foreground text-sm font-medium",children:s}),e[0]=s,e[1]=i):i=e[1];const c=`text-2xl font-bold ${a??""}`;let u;e[2]!==c||e[3]!==r?(u=t.jsx("p",{className:c,children:r}),e[2]=c,e[3]=r,e[4]=u):u=e[4];let h;e[5]!==o?(h=o&&t.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:o}),e[5]=o,e[6]=h):h=e[6];let x;e[7]!==i||e[8]!==u||e[9]!==h?(x=t.jsxs("div",{children:[i,u,h]}),e[7]=i,e[8]=u,e[9]=h,e[10]=x):x=e[10];let g;e[11]!==l?(g=t.jsx("div",{className:"bg-muted rounded-lg p-3",children:t.jsx(l,{className:"text-muted-foreground size-5"})}),e[11]=l,e[12]=g):g=e[12];let S;return e[13]!==x||e[14]!==g?(S=t.jsx(Z,{children:t.jsx(J,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[x,g]})})}),e[13]=x,e[14]=g,e[15]=S):S=e[15],S}function fn(n){const e=L.c(5),{value:s,max:r,colorClass:o}=n,l=r>0?Math.min(s/r*100,100):0,a=`h-2 rounded-full ${o}`,i=`${l}%`;let c;e[0]!==i?(c={width:i},e[0]=i,e[1]=c):c=e[1];let u;return e[2]!==a||e[3]!==c?(u=t.jsx("div",{className:"bg-muted h-2 w-full rounded-full",children:t.jsx("div",{className:a,style:c})}),e[2]=a,e[3]=c,e[4]=u):u=e[4],u}function xn(n){const e=L.c(6),{data:s}=n;if(s.length===0){let a;return e[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsxs("div",{className:"text-muted-foreground flex flex-col items-center gap-2 py-12 text-sm",children:[t.jsx(ye,{className:"size-8 opacity-40"}),t.jsx("p",{children:"No time-series data available for this period."}),t.jsx("p",{className:"text-xs",children:"Try capturing a snapshot first."})]}),e[0]=a):a=e[0],a}let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("thead",{children:t.jsxs("tr",{className:"text-muted-foreground border-b text-left text-xs",children:[t.jsx("th",{className:"px-3 py-2 font-medium",children:"Time"}),t.jsx("th",{className:"px-3 py-2 font-medium",children:"Avg Temp"}),t.jsx("th",{className:"px-3 py-2 font-medium",children:"Min / Max"}),t.jsx("th",{className:"px-3 py-2 font-medium",children:"Avg Humidity"}),t.jsx("th",{className:"px-3 py-2 font-medium",children:"Min / Max"}),t.jsx("th",{className:"px-3 py-2 font-medium text-right",children:"Readings"})]})}),e[1]=r):r=e[1];let o;e[2]!==s?(o=s.map(hn),e[2]=s,e[3]=o):o=e[3];let l;return e[4]!==o?(l=t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[r,t.jsx("tbody",{children:o})]})}),e[4]=o,e[5]=l):l=e[5],l}function hn(n){return t.jsxs("tr",{className:"hover:bg-muted/50 border-b transition-colors",children:[t.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:n.time_bucket}),t.jsxs("td",{className:`px-3 py-2 font-semibold ${Xe(n.avg_temp)}`,children:[M(n.avg_temp),"°"]}),t.jsxs("td",{className:"text-muted-foreground px-3 py-2 text-xs",children:[t.jsxs("span",{className:"text-blue-500",children:[M(n.min_temp),"°"]})," / ",t.jsxs("span",{className:"text-red-500",children:[M(n.max_temp),"°"]})]}),t.jsxs("td",{className:`px-3 py-2 font-semibold ${Ye(n.avg_humidity)}`,children:[M(n.avg_humidity),"%"]}),t.jsxs("td",{className:"text-muted-foreground px-3 py-2 text-xs",children:[M(n.min_humidity),"% / ",M(n.max_humidity),"%"]}),t.jsx("td",{className:"px-3 py-2 text-right font-mono text-xs",children:n.reading_count})]},n.time_bucket)}function gn(n){const e=L.c(10),{devices:s}=n;if(s.length===0){let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsxs("div",{className:"text-muted-foreground flex flex-col items-center gap-2 py-12 text-sm",children:[t.jsx(Oe,{className:"size-8 opacity-40"}),t.jsx("p",{children:"No device data available."})]}),e[0]=i):i=e[0],i}let r;e[1]!==s?(r=Math.max(...s.map(vn)),e[1]=s,e[2]=r):r=e[2];const o=r;let l;if(e[3]!==s||e[4]!==o){let i;e[6]!==o?(i=c=>t.jsxs(Z,{className:"gap-3 py-4",children:[t.jsxs(Ue,{className:"pb-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(We,{className:"text-sm",children:c.device_name}),t.jsxs(de,{variant:"outline",className:"text-xs font-mono",children:[c.reading_count," readings"]})]}),t.jsx(Ke,{className:"font-mono text-xs",children:c.device_id})]}),t.jsxs(J,{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(Oe,{className:"text-muted-foreground size-3.5"}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"Temperature"})]}),t.jsxs("div",{className:"flex items-baseline gap-3",children:[t.jsxs("span",{className:`text-lg font-bold ${Xe(c.avg_temp)}`,children:[M(c.avg_temp),"°"]}),t.jsxs("span",{className:"text-muted-foreground text-xs",children:[t.jsx(rs,{className:"inline size-3 text-blue-500"}),M(c.min_temp),"°"," ",t.jsx(as,{className:"inline size-3 text-red-500"}),M(c.max_temp),"°"]})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(lt,{className:"text-muted-foreground size-3.5"}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"Humidity"})]}),t.jsxs("div",{className:"flex items-baseline gap-3",children:[t.jsxs("span",{className:`text-lg font-bold ${Ye(c.avg_humidity)}`,children:[M(c.avg_humidity),"%"]}),t.jsxs("span",{className:"text-muted-foreground text-xs",children:[M(c.min_humidity),"% – ",M(c.max_humidity),"%"]})]})]}),t.jsx(fn,{value:c.reading_count,max:o,colorClass:"bg-primary"}),(c.alarm_count>0||c.offline_count>0)&&t.jsxs("div",{className:"flex gap-3 pt-1",children:[c.alarm_count>0&&t.jsxs(de,{variant:"destructive",className:"text-xs",children:[t.jsx(xe,{className:"mr-1 size-3"}),c.alarm_count," alarms"]}),c.offline_count>0&&t.jsxs(de,{variant:"secondary",className:"text-xs",children:[t.jsx(it,{className:"mr-1 size-3"}),c.offline_count," offline"]})]})]})]},c.device_id),e[6]=o,e[7]=i):i=e[7],l=s.map(i),e[3]=s,e[4]=o,e[5]=l}else l=e[5];let a;return e[8]!==l?(a=t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:l}),e[8]=l,e[9]=a):a=e[9],a}function vn(n){return n.reading_count}function yn({stores:n}){const[e,s]=d.useState(n.length>0?n[0].id:null),[r,o]=d.useState("daily"),[l,a]=d.useState(null),[i,c]=d.useState(!1),[u,h]=d.useState(!1),[x,g]=d.useState(null),[S,N]=d.useState(null),f=d.useCallback(async()=>{if(e){c(!0),g(null);try{const p=new URLSearchParams({store_id:String(e),period:r}),v=await fetch(`/api/reports/data?${p}`,{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(!v.ok){const C=await v.json().catch(()=>null);throw new Error(C?.message||C?.error||`Server error (${v.status})`)}const I=await v.json();I.success?(a(I),N(new Date)):g(I.error||"Failed to load report data")}catch(p){g(p instanceof Error?p.message:"Failed to load report")}finally{c(!1)}}},[e,r]),j=async()=>{if(e){h(!0),g(null);try{const p=await fetch("/api/reports/snapshot",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":jn()},credentials:"include",body:JSON.stringify({store_id:e})});if(!p.ok){const I=await p.json().catch(()=>null);throw new Error(I?.message||I?.error||`Snapshot failed (${p.status})`)}const v=await p.json();v.success?await f():g(v.error||"Snapshot failed")}catch(p){g(p instanceof Error?p.message:"Snapshot failed")}finally{h(!1)}}};d.useEffect(()=>{f()},[f]);const w=n.find(p=>p.id===e);return n.length===0?t.jsx(Z,{children:t.jsxs(J,{className:"flex flex-col items-center gap-4 py-12",children:[t.jsx(ye,{className:"text-muted-foreground size-12 opacity-40"}),t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"No Stores Found"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Create a store and link devices to start generating reports."})]})]})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs(je,{value:String(e??""),onValueChange:p=>s(Number(p)),children:[t.jsx(Ne,{className:"w-55",children:t.jsx(Se,{placeholder:"Select a store"})}),t.jsx(be,{children:n.map(p=>t.jsxs(we,{value:String(p.id),children:[p.store_name," (",p.store_number,")"]},p.id))})]}),t.jsx("div",{className:"flex rounded-lg border",children:["daily","weekly","monthly"].map(p=>t.jsx("button",{onClick:()=>o(p),className:`px-4 py-2 text-sm font-medium capitalize transition-colors ${r===p?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground"} ${p==="daily"?"rounded-l-lg":""} ${p==="monthly"?"rounded-r-lg":""}`,children:p},p))}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[S&&t.jsxs("span",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[t.jsx($e,{className:"size-3"}),S.toLocaleTimeString()]}),t.jsx(z,{variant:"outline",size:"sm",onClick:j,disabled:u||!e,children:u?t.jsxs(t.Fragment,{children:[t.jsx(Q,{className:"size-3.5"}),"Capturing…"]}):t.jsxs(t.Fragment,{children:[t.jsx(Qe,{className:"size-3.5"}),"Capture Snapshot"]})}),t.jsxs(z,{variant:"outline",size:"sm",onClick:f,disabled:i||!e,children:[i?t.jsx(Q,{className:"size-3.5"}):t.jsx(rt,{className:"size-3.5"}),"Refresh"]})]})]}),x&&t.jsx(Z,{className:"border-destructive bg-destructive/5",children:t.jsxs(J,{className:"flex items-center gap-3 py-4",children:[t.jsx(xe,{className:"size-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:x}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Try capturing a snapshot or check your YoSmart credentials."})]})]})}),i&&!l&&t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((p,v)=>t.jsx(Z,{children:t.jsxs(J,{className:"pt-6",children:[t.jsx(De,{className:"mb-2 h-4 w-24"}),t.jsx(De,{className:"mb-1 h-8 w-20"}),t.jsx(De,{className:"h-3 w-32"})]})},v))}),l&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl font-semibold",children:[st(r)," Report"]}),t.jsxs("p",{className:"text-muted-foreground text-sm",children:[w?.store_name," •"," ",tt(l.range.from)," – ",tt(l.range.to)]})]}),t.jsxs(de,{variant:"outline",className:"text-xs",children:[t.jsx(is,{className:"mr-1 size-3"}),l.overall.total_readings," total readings"]})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsx(ve,{label:"Avg Temperature",value:`${M(l.overall.avg_temp)}°`,subtitle:`${M(l.overall.min_temp)}° – ${M(l.overall.max_temp)}°`,icon:Oe,colorClass:Xe(l.overall.avg_temp)}),t.jsx(ve,{label:"Avg Humidity",value:`${M(l.overall.avg_humidity)}%`,icon:lt,colorClass:Ye(l.overall.avg_humidity)}),t.jsx(ve,{label:"Alarms",value:String(l.overall.total_alarms??0),subtitle:l.overall.total_alarms>0?"Events detected":"No alarms",icon:xe,colorClass:l.overall.total_alarms>0?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}),t.jsx(ve,{label:"Offline Events",value:String(l.overall.total_offline??0),subtitle:l.overall.total_offline>0?"Connectivity issues":"All online",icon:it,colorClass:l.overall.total_offline>0?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"})]}),t.jsxs(Z,{children:[t.jsxs(Ue,{children:[t.jsxs(We,{className:"flex items-center gap-2",children:[t.jsx(ye,{className:"size-5"}),"Time Series — ",st(r)]}),t.jsxs(Ke,{children:["Temperature and humidity aggregated by"," ",r==="daily"?"hour":"day","."]})]}),t.jsx(J,{children:t.jsx(xn,{data:l.time_series})})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Per-Device Summary"}),t.jsx(gn,{devices:l.device_summary})]})]}),!i&&!l&&!x&&t.jsx(Z,{children:t.jsxs(J,{className:"flex flex-col items-center gap-4 py-12",children:[t.jsx(ye,{className:"text-muted-foreground size-12 opacity-40"}),t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"No Report Data Yet"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Select a store and capture a snapshot to start generating reports."})]}),t.jsxs(z,{onClick:j,disabled:u||!e,children:[u?t.jsx(Q,{className:"size-4"}):t.jsx(Qe,{className:"size-4"}),"Capture First Snapshot"]})]})})]})}function jn(){const s=`; ${document.cookie}`.split("; XSRF-TOKEN=");return s.length===2?decodeURIComponent(s.pop()?.split(";").shift()??""):""}const He=[{value:5,label:"Every 5 minutes"},{value:10,label:"Every 10 minutes"},{value:15,label:"Every 15 minutes"},{value:30,label:"Every 30 minutes"},{value:60,label:"Every 1 hour"},{value:120,label:"Every 2 hours"},{value:180,label:"Every 3 hours"},{value:360,label:"Every 6 hours"},{value:720,label:"Every 12 hours"},{value:1440,label:"Every 24 hours"}];function Sn(n){const e=He.find(o=>o.value===n);if(e)return e.label;if(n<60)return`Every ${n} min`;const s=Math.floor(n/60),r=n%60;return r>0?`Every ${s}h ${r}m`:`Every ${s}h`}function Nn(n){if(!n)return"Never";const e=Date.now()-new Date(n).getTime(),s=Math.floor(e/6e4);if(s<1)return"Just now";if(s<60)return`${s}m ago`;const r=Math.floor(s/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function bn(n){if(!n)return"—";const e=new Date(n).getTime()-Date.now();if(e<=0)return"Now";const s=Math.floor(e/6e4);return s<60?`in ${s}m`:`in ${Math.floor(s/60)}h ${s%60}m`}function wn(){const s=`; ${document.cookie}`.split("; XSRF-TOKEN=");return s.length===2?decodeURIComponent(s.pop()?.split(";").shift()??""):""}async function ce(n,e={}){const s=await fetch(n,{...e,headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":wn(),...e.headers||{}},credentials:"include"});if(!s.ok){const r=await s.json().catch(()=>null);throw new Error(r?.message||r?.error||`Request failed (${s.status})`)}return s.json()}function Cn({stores:n}){const[e,s]=d.useState([]),[r,o]=d.useState(!0),[l,a]=d.useState(null),[i,c]=d.useState(null),[u,h]=d.useState(!1),[x,g]=d.useState(""),[S,N]=d.useState("60"),[f,j]=d.useState(!1),[w,p]=d.useState(null),[v,I]=d.useState("60"),C=d.useCallback(async()=>{try{o(!0);const m=await ce("/api/reports/schedules");m.success&&s(m.schedules)}catch(m){a(m instanceof Error?m.message:"Failed to load schedules")}finally{o(!1)}},[]);d.useEffect(()=>{C()},[C]);const ne=new Set(e.map(m=>m.store_id)),P=n.filter(m=>!ne.has(m.id)),$=async()=>{if(!(!x||!S)){j(!0),a(null);try{await ce("/api/reports/schedules",{method:"POST",body:JSON.stringify({store_id:Number(x),is_active:!0,interval_minutes:Number(S)})}),h(!1),g(""),N("60"),await C()}catch(m){a(m instanceof Error?m.message:"Failed to create schedule")}finally{j(!1)}}},U=async m=>{c(m.id),a(null);try{await ce(`/api/reports/schedules/${m.id}/toggle`,{method:"PATCH"}),await C()}catch(b){a(b instanceof Error?b.message:"Failed to toggle schedule")}finally{c(null)}},q=async m=>{if(confirm(`Remove schedule for "${m.store?.store_name}"?`)){c(m.id),a(null);try{await ce(`/api/reports/schedules/${m.id}`,{method:"DELETE"}),await C()}catch(b){a(b instanceof Error?b.message:"Failed to delete schedule")}finally{c(null)}}},V=async m=>{c(m.id),a(null);try{const b=await ce(`/api/reports/schedules/${m.id}/run-now`,{method:"POST"});b.success?await C():a(b.error||"Run failed")}catch(b){a(b instanceof Error?b.message:"Run failed")}finally{c(null)}},B=async m=>{c(m.id),a(null);try{await ce("/api/reports/schedules",{method:"POST",body:JSON.stringify({store_id:m.store_id,is_active:m.is_active,interval_minutes:Number(v)})}),p(null),await C()}catch(b){a(b instanceof Error?b.message:"Failed to update")}finally{c(null)}};return t.jsxs(Z,{children:[t.jsx(Ue,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs(We,{className:"flex items-center gap-2",children:[t.jsx(vs,{className:"size-5"}),"Automated Snapshot Schedules"]}),t.jsx(Ke,{children:"Configure automatic sensor data capture intervals for each store. The scheduler runs via cron and captures snapshots at the configured frequency."})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z,{variant:"outline",size:"sm",onClick:C,disabled:r,children:r?t.jsx(Q,{className:"size-3.5"}):t.jsx(rt,{className:"size-3.5"})}),P.length>0&&t.jsxs(z,{size:"sm",onClick:()=>h(!u),children:[t.jsx(Je,{className:"size-3.5"}),"Add Schedule"]})]})]})}),t.jsxs(J,{className:"space-y-4",children:[l&&t.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-900 dark:bg-red-950/50 dark:text-red-400",children:[t.jsx(xe,{className:"size-4 shrink-0"}),l]}),u&&t.jsxs("div",{className:"flex flex-wrap items-end gap-3 rounded-lg border bg-muted/30 p-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("label",{className:"text-xs font-medium",children:"Store"}),t.jsxs(je,{value:x,onValueChange:g,children:[t.jsx(Ne,{className:"w-52",children:t.jsx(Se,{placeholder:"Select store"})}),t.jsx(be,{children:P.map(m=>t.jsxs(we,{value:String(m.id),children:[m.store_name," (",m.store_number,")"]},m.id))})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("label",{className:"text-xs font-medium",children:"Interval"}),t.jsxs(je,{value:S,onValueChange:N,children:[t.jsx(Ne,{className:"w-44",children:t.jsx(Se,{})}),t.jsx(be,{children:He.map(m=>t.jsx(we,{value:String(m.value),children:m.label},m.value))})]})]}),t.jsxs(z,{size:"sm",onClick:$,disabled:!x||f,children:[f?t.jsx(Q,{className:"size-3.5"}):t.jsx(Je,{className:"size-3.5"}),"Create"]}),t.jsx(z,{variant:"ghost",size:"sm",onClick:()=>h(!1),children:"Cancel"})]}),r&&e.length===0&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Q,{className:"size-6"})}),!r&&e.length===0&&t.jsxs("div",{className:"flex flex-col items-center gap-3 py-10 text-center",children:[t.jsx($e,{className:"text-muted-foreground size-10 opacity-40"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"No schedules configured"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Add a schedule to automatically capture sensor snapshots at regular intervals."})]})]}),e.length>0&&t.jsx("div",{className:"space-y-3",children:e.map(m=>t.jsxs("div",{className:`flex flex-wrap items-center gap-4 rounded-lg border p-4 transition-colors ${m.is_active?"border-emerald-200 bg-emerald-50/50 dark:border-emerald-900 dark:bg-emerald-950/20":"border-muted bg-muted/20"}`,children:[t.jsxs("div",{className:"min-w-40 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:m.store?.store_name??"Unknown Store"}),t.jsx(de,{variant:m.is_active?"default":"secondary",className:"text-xs",children:m.is_active?"Active":"Paused"}),m.consecutive_failures>0&&t.jsxs(de,{variant:"destructive",className:"text-xs",children:[m.consecutive_failures," failures"]})]}),t.jsx("p",{className:"text-muted-foreground mt-0.5 font-mono text-xs",children:m.store?.store_number})]}),t.jsx("div",{className:"text-center",children:w===m.id?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(je,{value:v,onValueChange:I,children:[t.jsx(Ne,{className:"h-8 w-40 text-xs",children:t.jsx(Se,{})}),t.jsx(be,{children:He.map(b=>t.jsx(we,{value:String(b.value),children:b.label},b.value))})]}),t.jsx(z,{variant:"outline",size:"sm",className:"h-8",onClick:()=>B(m),disabled:i===m.id,children:i===m.id?t.jsx(Q,{className:"size-3"}):t.jsx(us,{className:"size-3"})}),t.jsx(z,{variant:"ghost",size:"sm",className:"h-8",onClick:()=>p(null),children:"Cancel"})]}):t.jsxs("button",{className:"text-muted-foreground hover:text-foreground cursor-pointer text-sm transition-colors",onClick:()=>{p(m.id),I(String(m.interval_minutes))},title:"Click to change interval",children:[t.jsx($e,{className:"mr-1 inline size-3.5"}),Sn(m.interval_minutes)]})}),t.jsxs("div",{className:"flex gap-4 text-xs",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-muted-foreground",children:"Last Run"}),t.jsx("p",{className:"font-medium",children:Nn(m.last_run_at)})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-muted-foreground",children:"Next Run"}),t.jsx("p",{className:"font-medium",children:m.is_active?bn(m.next_run_at):"—"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-muted-foreground",children:"Total Runs"}),t.jsx("p",{className:"font-medium",children:m.total_runs})]})]}),m.last_error&&t.jsx("div",{className:"w-full",children:t.jsxs("p",{className:"mt-1 truncate text-xs text-red-600 dark:text-red-400",title:m.last_error,children:[t.jsx(xe,{className:"mr-1 inline size-3"}),m.last_error]})}),t.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[t.jsx(z,{variant:"ghost",size:"sm",className:"h-8",onClick:()=>V(m),disabled:i===m.id,title:"Run snapshot now",children:i===m.id?t.jsx(Q,{className:"size-3.5"}):t.jsx(Ss,{className:"size-3.5"})}),t.jsx(z,{variant:"ghost",size:"sm",className:"h-8",onClick:()=>U(m),disabled:i===m.id,title:m.is_active?"Pause schedule":"Resume schedule",children:m.is_active?t.jsx(fs,{className:"size-3.5"}):t.jsx(hs,{className:"size-3.5"})}),t.jsx(z,{variant:"ghost",size:"sm",className:"h-8 text-red-500 hover:text-red-600",onClick:()=>q(m),disabled:i===m.id,title:"Remove schedule",children:t.jsx(ts,{className:"size-3.5"})})]})]},m.id))}),e.length>0&&t.jsxs("p",{className:"text-muted-foreground text-center text-xs",children:["The scheduler requires a cron job running"," ",t.jsx("code",{className:"rounded bg-muted px-1.5 py-0.5 text-xs",children:"php artisan schedule:run"})," ","every minute on your server."]})]})]})}const _n=[{title:"Dashboard",href:"/dashboard"},{title:"Reports",href:"/reports"}];function Fn(n){const e=L.c(3),{stores:s}=n;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(Ot,{title:"Sensor Reports"}),e[0]=r):r=e[0];let o;return e[1]!==s?(o=t.jsxs(Jt,{breadcrumbs:_n,children:[r,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 overflow-x-auto rounded-xl p-4 md:p-6",children:[t.jsx(yn,{stores:s}),t.jsx(Cn,{stores:s})]})]}),e[1]=s,e[2]=o):o=e[2],o}export{Fn as default};
